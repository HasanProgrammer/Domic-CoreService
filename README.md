<div dir="rtl" style="font-family: IRANSans">

### ğŸ† Ù…Ù‚Ø¯Ù…Ù‡

Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ØŒ ÛŒÚ© Ù¾Ø±ÙˆÚ˜Ù‡ Ø²ÛŒØ± Ø³Ø§Ø®ØªÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù¾Ø±ÙˆÚ˜Ù‡ `Template` Ø§Ø³Øª Ùˆ Ø´Ø§Ù…Ù„ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ø¨Ù‡ØªØ± Ùˆ Ù¾ÛŒØ´Ø±ÙØªÙ‡ ØªØ± Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù…ÛŒÚ©Ø±ÙˆØ³Ø±ÙˆÛŒØ³ Ù…ÛŒ Ø¨Ø§Ø´Ø¯ .

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **ØªÙ…Ø§Ù…ÛŒ Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ø¨Ù‡ Ø·ÙˆØ± Ø§Ø®ØªØµØ§ØµÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ù†Ø¯ Ùˆ Ø¯Ø§Ø±Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ù…Ø´Ø§Ø¨Ù‡ Ù†Ù…ÛŒ Ø¨Ø§Ø´Ù†Ø¯ .**

| Ù¾Ø±ÙˆÚ˜Ù‡                   | Ù„ÛŒÙ†Ú©                                                     |
|-------------------------|----------------------------------------------------------|
| `Domic-TemplateService` | https://github.com/HasanProgrammer/Domic-TemplateService |

Ø¨Ø±Ø®ÛŒ Ø§Ø² Ù‚Ø§Ø¨Ù„ÛŒØª Ù‡Ø§ Ùˆ Ø§Ù…Ú©Ø§Ù†Ø§Øª Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§ÛŒ Ø±ÙˆØ² Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù†Ø±Ù… Ø§ÙØ²Ø§Ø± Ú©Ù‡ Ø¯Ø± Ø§ÛŒÙ† Ø³ÙˆØ±Ø³ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª Ø¨Ù‡ Ø´Ø±Ø­ Ø²ÛŒØ± Ù…ÛŒ Ø¨Ø§Ø´Ø¯ :

| Ù‚Ø§Ø¨Ù„ÛŒØª               | ØªÙˆØ¶ÛŒØ­Ø§Øª                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **CQRS**             | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ø§Ø¨Ø²Ø§Ø± Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø§ØµÙ„ `CQS` Ùˆ Ø¨Ù‡ Ø·ÙˆØ± Ø¯Ù‚ÛŒÙ‚ ØªØ± Ø§Ù„Ú¯ÙˆÛŒ `CQRS` Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ø¨Ø²Ø§Ø± `Mediator` Ú©Ù‡ Ø¯Ø± Ø§ØµÙ„ Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ù¾ÛŒØ§Ø¯Ù‡ Ú©Ù†Ù†Ø¯Ù‡ Ø§Ù„Ú¯ÙˆÛŒ `Mediator` Ù…ÛŒ Ø¨Ø§Ø´Ø¯                                                                            |
| **AsyncCommand**     | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ù‚Ø§Ø¨Ù„ÛŒØª `Command` Ù‡Ø§ÛŒ `Async` Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø²ÛŒØ±Ø³Ø§Ø®Øª `Broker` Ùˆ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ø¨Ø²Ø§Ø± `RabbitMQ` Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù‡Ø§ÛŒ `Fire&Forget`                                                                                                      |
| **DistributedCache** | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ø§Ø¨Ø²Ø§Ø± Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª `Distributed Cache` Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø§Ø¨Ø²Ø§Ø± Ø²ÛŒØ±Ø³Ø§Ø®ØªÛŒ `Redis` Ø¨Ø±Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„Ø§ÛŒÙ‡ `Cache` Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡                                                                                                                  |
| **EDA**              | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ø§Ø¨Ø²Ø§Ø± Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ØªØ± Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡ ØªØ± `Event` Ùˆ ÛŒØ§ `Message` Ø¯Ø± Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ `RabbitMQ` Ùˆ `Apache Kafka`                                                                                                    |
| **Logger**           | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ø§Ø¨Ø²Ø§Ø± Ù„Ø§Ú¯ Ù…Ø±Ú©Ø²ÛŒ ÛŒØ§ Ù‡Ù…Ø§Ù† Ø³Ø±ÙˆÛŒØ³ ( `StateTracker` ) Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù„Ø§Ú¯ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ùˆ Ù„Ø§Ú¯ Ø±Ø®Ø¯Ø§Ø¯Ù‡Ø§ ( `Event Snapshot` ) Ùˆ ÛŒØ§ Ù„Ø§Ú¯ Ù‡Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø·Ø­ Ú©Ø¯Ù‡Ø§ÛŒ Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø± Ù…Ø±Ø¨ÙˆØ·Ù‡ ( `Logger` Ùˆ `StreamLogger` ) |
| **RPC**              | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ø²ÛŒØ±Ø³Ø§Ø®Øª Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù‡Ø§ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù¾Ø±ÙˆØªÚ©Ù„ `RPC` Ùˆ Ø¨Ø±Ø§Ø³Ø§Ø³ Ø§Ø¨Ø²Ø§Ø± `gRPC`                                                                                                                                                  |
| **ServiceDiscovery** | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ùˆ ÙˆØ§Ú©Ø´ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø³Ø±ÙˆÛŒØ³ `DiscoveryService` Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ø³Ù„Ø§Ù…Øª Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ ( `HealthCheck` ) Ø¨Ø±Ø§Ø³Ø§Ø³ Ú†Ø±Ø®Ù‡ Ø²Ù…Ø§Ù† Ø¨Ù†Ø¯ÛŒ Ù…Ø´Ø®Øµ                                                                          |
| **AuthFilters**      | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² ÙÛŒÙ„ØªØ± Ù‡Ø§ÛŒ Ø´Ø®ØµÛŒ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø³Ø·ÙˆØ­ Ø¯Ø³ØªØ±Ø³ÛŒ ( `Permission` ) Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙˆÚ©Ù† Ù‡Ø§ÛŒ `Revoke` Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø§Ø®ØªØ§Ø± `JWT`                                                                                                                    |
| **ExceptionHandler** | Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø±ÛŒ Ø§Ø² Ù„Ø§ÛŒÙ‡ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ù†Ø¯Ù‡ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø´Ø¯Ù‡ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø´Ø¯Ù‡ Ø¯Ø± Ù„Ø§ÛŒÙ‡ Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ù¾Ø±ÙˆÚ˜Ù‡ Ùˆ Ø¨Ø§Ø²Ú¯Ø´Øª Ù¾Ø§Ø³Ø® Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù‡ `Client`                                                                                                                          |

---

### ğŸ† Ø§Ø¨Ø²Ø§Ø± `Mediator` Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù„Ú¯ÙˆÛŒ `CQRS`

Ø¯Ø± Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢Ù†Ú©Ù‡ Ø¨ØªÙˆØ§Ù†ÛŒØ¯ Ù…Ù†Ø·Ù‚ Ù‡Ø§ÛŒ Ø¨Ø®Ø´ `Command` Ùˆ Ø¨Ø®Ø´ `Query` Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø¬Ø²Ø§ Ú©Ù†ÛŒØ¯ Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ú©Ù‡ Ø¨Ø§ Ù†Ø§Ù… `Mediator` Ø¯Ø± Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª Ø±Ø§ Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ .
Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ù‡ÛŒØ¯ Ù†Ø­ÙˆÙ‡ Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ú©Ù„Ø§Ø³ Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¨Ø®Ø´ `Command` Ùˆ Ø¨Ø®Ø´ `Query` Ø±Ø§ Ù…ÙˆØ±Ø¯ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒÙ… Ùˆ Ø¯Ø± Ø§Ù†ØªÙ‡Ø§ Ø¨Ù‡ Ù†Ø­ÙˆÙ‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§ÛŒÙ† Ù…Ù†Ø·Ù‚ Ù‡Ø§ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙˆØ§Ø³Ø· `Mediator` Ù…ÛŒ Ù¾Ø±Ø¯Ø§Ø²ÛŒÙ… .

1 . Ù†Ø­ÙˆÙ‡ ØªØ¹Ø±ÛŒÙ Ú©Ù„Ø§Ø³ Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¨Ø®Ø´ `Command` Ù…Ø·Ø§Ø¨Ù‚ Ø²ÛŒØ± Ù…ÛŒ Ø¨Ø§Ø´Ø¯

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    public CreateCommandHandler(){}
    
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }

    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>
 
2 . Ø¨Ø±Ø§ÛŒ ØªØ¹Ø±ÛŒÙ Ú©Ù„Ø§Ø³ Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù„Ø§Ø¬ÛŒÚ© Ø¨Ø®Ø´ `Query` Ù‡Ù… Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯

<div dir="ltr">

```csharp
public class ReadAllQuery : IQuery<Dto> //any result type
{
}

public class ReadAllQueryHandler : IQueryHandler<ReadAllQuery, Dto>
{
    public ReadAllQueryHandler(){}

    public Dto Handle(ReadAllQuery query)
    {
        //query
        
        return default;
    }
    
    public Task<Dto> HandleAsync(ReadAllQuery query, CancellationToken cancellationToken)
    {
        //query
        
        return Task.FromResult<Dto>(default);
    }
}
```

</div>

3 . ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø§Ø¨Ø²Ø§Ø± `Mediator` Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù…Ø±Ø¨ÙˆØ·Ù‡

Ø¯Ø± Ù†Ù‡Ø§ÛŒØª Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ø®ÙˆØ¯ ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Presentation` Ùˆ Ø¯Ø± ÙØ§ÛŒÙ„ `Program.cs` Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
WebApplicationBuilder builder = WebApplication.CreateBuilder();

builder.RegisterCommandQueryUseCases();
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ù‚Øª Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ `Command` Ùˆ `Query` Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ù„Ø§ÛŒÙ‡ `UseCase` Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ Ùˆ Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‚Ø±Ø§Ø± Ø¨Ú¯ÛŒØ±Ù†Ø¯**

---
 
### ğŸ† Ù‚Ø§Ø¨Ù„ÛŒØª Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø§Ø¨Ø²Ø§Ø± `Mediator`

1 . Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `WithTransactionAttribute`

Ø§Ø² Ø§ÛŒÙ† `Attribute` Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ù‚Ø¹ÛŒ Ú©Ù‡ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ ØªØ§ Ø¹Ù…Ù„ÛŒØ§Øª `Command` Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ø¯Ø§Ø®Ù„ ÛŒÚ© `Transaction` Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆØ¯ Ú©Ù‡ Ø¯Ø§Ø±Ø§ÛŒ ÛŒÚ© `Property` ØªØ­Øª Ø¹Ù†ÙˆØ§Ù† `IsolationLevel` Ù…ÛŒ Ø¨Ø§Ø´Ø¯ Ú©Ù‡ Ø³Ø·Ø­ Ù‚ÙÙ„ Ú¯Ø²Ø§Ø±ÛŒ Ù…Ù†Ø·Ù‚ Ø´Ù…Ø§ Ø±Ø§ Ø¯Ø± Ø¯Ø§Ø®Ù„ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÛŒ Ú©Ù†Ø¯ ( `Pessimistic Lock` ) .

Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ø³Ø·Ø­ Ù„Ø§ÛŒÙ‡ `Domain` Ø³Ø±ÙˆÛŒØ³ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ ÛŒÚ© ÙˆØ§Ø³Ø· Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ú©Ø±Ø¯Ù‡ Ú©Ù‡ Ø§Ø² ÙˆØ§Ø³Ø· `ICoreCommandUnitOfWork` Ø§Ø±Ø« Ø¨Ø±ÛŒ Ú©Ø±Ø¯Ù‡ Ø§Ø³ØªØŒ Ù…Ø·Ø§Ø¨Ù‚ Ú©Ø¯ Ø²ÛŒØ± :

<div dir="ltr">

```csharp
public interface ICommandUnitOfWork : ICoreCommandUnitOfWork;
```

</div>

Ø³Ù¾Ø³ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Infrastructure` Ø³Ø±ÙˆÛŒØ³ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø§ÛŒÙ† ÙˆØ§Ø³Ø· Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´ÙˆØ¯ ØŒ Ù…Ø·Ø§Ø¨Ù‚ Ú©Ø¯ Ø²ÛŒØ± :

<div dir="ltr">

```csharp
public class CommandUnitOfWork : ICommandUnitOfWork
{
    private readonly SQLContext   _context;
    private IDbContextTransaction _transaction;

    public CommandUnitOfWork(SQLContext context) => _context = context; //Resource

    public void Transaction(IsolationLevel isolationLevel) 
        => _transaction = _context.Database.BeginTransaction(isolationLevel); //Resource

    public async Task TransactionAsync(IsolationLevel isolationLevel = IsolationLevel.ReadCommitted,
        CancellationToken cancellationToken = new CancellationToken())
    {
        _transaction = await _context.Database.BeginTransactionAsync(isolationLevel, cancellationToken); //Resource
    }

    public void Commit()
    {
        _context.SaveChanges();
        _transaction.Commit();
    }

    public async Task CommitAsync(CancellationToken cancellationToken)
    {
        await _context.SaveChangesAsync(cancellationToken);
        await _transaction.CommitAsync(cancellationToken);
    }

    public void Rollback() => _transaction?.Rollback();

    public Task RollbackAsync(CancellationToken cancellationToken)
    {
        if (_transaction is not null)
            return _transaction.RollbackAsync(cancellationToken);

        return Task.CompletedTask;
    }

    public void Dispose() => _transaction?.Dispose();

    public ValueTask DisposeAsync()
    {
        if (_transaction is not null)
            return _transaction.DisposeAsync();

        return ValueTask.CompletedTask;
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± Ù†Ø¸Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø§ÛŒÙ† Ù…ÙˆØ§Ø±Ø¯ Ø¨Ù‡ Ø·ÙˆØ± Ù¾ÛŒØ´ÙØ±Ø¶ Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ `Template` Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ù†Ø¯**

Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `Attribute` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø·Ø§Ø¨Ù‚ Ú©Ø¯ Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    public CreateCommandHandler(){}

    [WithTransaction]
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }

    [WithTransaction]
    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ Ù…Ù‚Ø¯Ø§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒ `IsolationLevel` Ø¯Ø± Ø§ÛŒÙ† `Attribute` Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ‡ Ù†Ø´ÙˆØ¯ØŒ Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´ÙØ±Ø¶ `ReadCommitted` Ù„Ø­Ø§Ø¸ Ù…ÛŒ Ú¯Ø±Ø¯Ø¯**

Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `Attribute` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø¨Ø§ Ù…Ù‚Ø¯Ø§Ø± `IsolationLevel` Ù…Ø´Ø®Øµ Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø·Ø§Ø¨Ù‚ Ú©Ø¯ Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    public CreateCommandHandler(){}

    [WithTransaction(IsolationLevel = IsolationLevel.RepeatableRead)]
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }

    [WithTransaction(IsolationLevel = IsolationLevel.RepeatableRead)]
    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ú©Ø±Ø¯ ØµØ­ÛŒØ­ `WithTransaction` Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ø®ÙˆØ¯ ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø§ÛŒÙ† `Attribute` Ø±Ø§ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ù†Ù…Ø§ÛŒÛŒØ¯**

Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ `WithTransaction` Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ø®ÙˆØ¯ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Presentation` Ùˆ Ø¯Ø± ÙØ§ÛŒÙ„ `Program.cs` Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
WebApplicationBuilder builder = WebApplication.CreateBuilder();

builder.RegisterCommandRepositories();
```

</div>

2 . Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `WithValidationAttribute`

Ø§Ø² Ø§ÛŒÙ† `Attribute` Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ù‚Ø¹ÛŒ Ú©Ù‡ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ `Command` ÛŒØ§ `Query` Ø®ÙˆØ¯ Ø¯Ø§Ø±ÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆØ¯ . Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ú©Ù„Ø§Ø³ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `Validator` Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯ Ùˆ Ø³Ù¾Ø³ Ø§Ù‚Ø¯Ø§Ù… Ø¨Ù‡ Ú¯Ø°Ø§Ø´ØªÙ† `WithValidation` Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommandValidator : IValidator<CreateCommand>
{
    public CreateCommandValidator(){}
    
    public object Validate(CreateCommand input)
    {
        //validations
        
        return default;
    }

    public Task<object> ValidateAsync(CreateCommand input, CancellationToken cancellationToken)
    {
        //validations
        
        return Task.FromResult(default(object));
    }
}
```

</div>

Ú©Ø¯Ù‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ø±Ø¯ Ø³Ù…Øª `Query` Ù†ÛŒØ² ØµØ¯Ù‚ Ù…ÛŒ Ú©Ù†Ø¯ Ùˆ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù‡Ù… Ù…ÛŒ ØªÙˆØ§Ù† Ø§Ø² Ø¯Ø³ØªÙˆØ±Ø§Øª Ø¨Ø§Ù„Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø±Ø¯ ØŒ Ø­Ø§Ù„ Ù…ÛŒ ØªÙˆØ§Ù† Ø§Ø² Ø§ÛŒÙ† `Attribute` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø±Ø¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    public CreateCommandHandler(){}

    [WithValidation]
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }

    [WithValidation]
    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± Ú©Ø¯ Ø¨Ø§Ù„Ø§ Ùˆ Ø¯Ø± Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ú©Ù„Ø§Ø³ `Validator` Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ Ø´Ù…Ø§ Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ù†ØªÛŒØ¬Ù‡ Ù…ØªØ¯ `Validate` Ùˆ ÛŒØ§ `ValidateAsync` Ø±Ø§ Ú©Ù‡ ÛŒÚ© `object` Ù…ÛŒ Ø¨Ø§Ø´Ø¯ Ø¯Ø± Ø¯Ø§Ø®Ù„ `CommandHandler` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯**

Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ù‡Ù… ØŒ Ú©Ø§ÙÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¯Ø± Ù‚Ø³Ù…Øª `CommandHandler` Ø®ÙˆØ¯ ÛŒÚ© Ù…ØªØºÛŒØ± Ø§Ø² Ù†ÙˆØ¹ `object` Ùˆ Ø¨Ø§ Ù†Ø§Ù… `validationResult_` Ùˆ Ø¨Ù‡ Ø´Ú©Ù„ `readonly` Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    private readonly object _validationResult;
    
    public CreateCommandHandler(){}

    [WithValidation]
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }

    [WithValidation]
    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>

3 . Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `WithCleanCacheAttribute`

Ø¯Ø± Ù‚Ø³Ù…Øª `Command` Ø¯Ø± Ù…ÙˆØ§Ù‚Ø¹ÛŒ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ Ú©Ù‡ Ù¾Ø³ Ø§Ø² Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù† Ù„Ø§Ø¬ÛŒÚ© Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ `Cache` Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒØª Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø­Ø°Ù Ù†Ù…Ø§ÛŒÛŒØ¯ ØªØ§ Ù…Ø¬Ø¯Ø¯ Ø¯Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¯ÛŒÚ¯Ø±ÛŒ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ù‚Ø³Ù…Øª `Query` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒ Ø´ÙˆØ¯ ØŒ `Cache` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆØ¯ .
Ø¨Ø±Ø§ÛŒ Ø³Ù‡ÙˆÙ„Øª Ø¯Ø± Ø§ÛŒÙ† Ú©Ø§Ø± Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø§ÛŒÙ† `Attribute` Ù…Ø·Ø§Ø¨Ù‚ Ú©Ø¯ Ù‡Ø§ÛŒ Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    public CreateCommandHandler(){}

    [WithCleanCache(Keies = "Key1|Key2|...")]
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }

    [WithCleanCache(Keies = "Key1|Key2|...")]
    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>

4 . Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `WithPessimisticConcurrencyAttribute`

Ø¯Ø± Ù…ÙˆØ§Ù‚Ø¹ÛŒ Ú©Ù‡ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ ØªØ§ Ù…Ù†Ø·Ù‚ Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `Command` Ø®ÙˆØ¯ Ø±Ø§ Ú©Ù‡ ÛŒÚ© `Critical Section` Ù…ÛŒ Ø¨Ø§Ø´Ø¯ Ø¯Ø± Ø¯Ø§Ø®Ù„ Ø¨Ù„ÙˆÚ© `lock` Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ Ú©Ù‡ ØªÙ†Ù‡Ø§ ÛŒÚ© ÛŒØ§ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø´Ø®ØµÛŒ `Thread` Ø¨ØªÙˆØ§Ù†Ù†Ø¯ Ø¨Ù‡ Ø¢Ù† Ø¨Ø®Ø´ `Critical` Ø¯Ø³ØªØ±Ø³ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯ ØŒ Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø§ÛŒÙ† `Attribute` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…Ø§ÛŒÛŒØ¯ .

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¨Ø±Ø§ÛŒ Ù…ØªØ¯ `Handle` Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¯Ø§Ø®Ù„ `CommandHandler` Ø®ÙˆØ¯ ÛŒÚ© Ù…ØªØºÛŒØ± Ø§Ø² Ù†ÙˆØ¹ `object` Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯ Ùˆ Ø¨Ø±Ø§ÛŒ `HandleAsync` Ø¨Ø§ÛŒØ¯ ÛŒÚ© Ù…ØªØºÛŒØ± Ø§Ø² Ù†ÙˆØ¹ `SemaphoreSlim` Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯**

Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† `Attribute` Ùˆ Ø¯Ø± Ú©Ù†Ø§Ø± Ù…ØªØ¯ `Handle` Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `Command` Ø¨Ø§ÛŒØ¯ Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    private static object _lock = new();
    
    public CreateCommandHandler(){}

    [WithPessimisticConcurrency]
    public string Handle(CreateCommand command)
    {
       //logic
        
        return default;
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± Ú©Ø¯ Ø¨Ø§Ù„Ø§ ØŒ Ø­ØªÙ…Ø§ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù†Ø§Ù… Ù…ØªØºÛŒØ± Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ú©Ù„ÛŒØ¯ Ù‚ÙÙ„ Ú¯Ø°Ø§Ø±ÛŒ ØŒ `lock_` Ø¨Ø§Ø´Ø¯**

Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† `Attribute` Ùˆ Ø¯Ø± Ú©Ù†Ø§Ø± Ù…ØªØ¯ `HandleAsync` Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `Command` Ø¨Ø§ÛŒØ¯ Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class CreateCommand : ICommand<string> //any result type
{
    //some properties
}

public class CreateCommandHandler : ICommandHandler<CreateCommand, string>
{
    private static SemaphoreSlim _asyncLock = new(1, 1); //custom count of thread
    
    public CreateCommandHandler(){}

    [WithPessimisticConcurrency]
    public Task<string> HandleAsync(CreateCommand command, CancellationToken cancellationToken)
    {
       //logic
        
       return Task.FromResult<string>(default);
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± Ú©Ø¯ Ø¨Ø§Ù„Ø§ ØŒ Ø­ØªÙ…Ø§ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù†Ø§Ù… Ù…ØªØºÛŒØ± Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ú©Ù„ÛŒØ¯ Ù‚ÙÙ„ Ú¯Ø°Ø§Ø±ÛŒ ØŒ `asyncLock_` Ø¨Ø§Ø´Ø¯**

---

### ğŸ† Ø§Ø¨Ø²Ø§Ø± `ExternalDistributedCache` Ùˆ `InternalDistributedCache` Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª `Cache`

Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ´Ø±ÙØªÙ‡ ØªØ± Ùˆ Ø®ÙˆØ§Ù†Ø§ ØªØ± `Cache` Ù‡Ø§ÛŒ Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø·Ø­ Ù¾Ø±ÙˆÚ˜Ù‡ Ú©Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ `Redis` Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª Ù…ÛŒ ØªÙˆØ§Ù†ÛŒØ¯ ØŒ Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ± Ø§Ù„Ø¹Ù…Ù„ Ù‡Ø§ÛŒ Ø²ÛŒØ± Ø§Ù‚Ø¯Ø§Ù… Ù†Ù…Ø§ÛŒÛŒØ¯ .

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø§Ø² ÙˆØ§Ø³Ø· `IInternalDistributedCache` Ø¨Ø±Ø§ÛŒ `Redis` Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³ Ø¬Ø§Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆØ¯ Ùˆ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± Ø¨Ù‡ Ø§ÛŒÙ† `Cache` Ø¯Ø³ØªØ±Ø³ÛŒ Ù†Ø¯Ø§Ø±Ù†Ø¯**

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø§Ø² ÙˆØ§Ø³Ø· `IExternalDistributedCache` Ø¨Ø±Ø§ÛŒ `Redis` Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ù‡Ù…Ù‡ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆØ¯ ØŒ Ø¯Ø±ÙˆØ§Ù‚Ø¹ Ù¾ÛŒØ§Ø¯Ù‡ Ú©Ù†Ù†Ø¯Ù‡ Ø§ÛŒÙ† ÙˆØ§Ø³Ø· Ø§Ø² `Redis` Ù…Ø´ØªØ±Ú© Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒ Ú©Ù†Ø¯**

1 . ØªØ¹Ø±ÛŒÙ Ú©Ù„Ø§Ø³ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù…Ù†Ø·Ù‚ Ø¯ÛŒØªØ§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ `Cache`

Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ ØŒ Ø´Ù…Ø§ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ú©Ù„Ø§Ø³ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù…Ù†Ø·Ù‚ `Cache` Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
//for current service distributed cahce
public class MemoryCache : IInternalDistributedCacheHandler<List<Dto>>
{
    public MemoryCache(){}

    [Config(Key = 'Key', Ttl = 60 /*time to live based on minute*/)]
    public List<Dto> Set()
    {
        //query
        
        return new();
    }
    
    [Config(Key = 'Key', Ttl = 60 /*time to live based on minute*/)]
    public Task<List<Dto>> SetAsync(CancellationToken cancellationToken)
    {
        //query
        
        return Task.FromResult(new());
    }
}

//for all services distributed cahce ( global | share cahce )
public class MemoryCache : IExternalDistributedCacheHandler<List<Dto>>
{
    public MemoryCache(){}

    [Config(Key = 'Key', Ttl = 60 /*time to live based on minute*/)]
    public List<Dto> Set()
    {
        //query
        
        return new();
    }
    
    [Config(Key = 'Key', Ttl = 60 /*time to live based on minute*/)]
    public Task<List<Dto>> SetAsync(CancellationToken cancellationToken)
    {
        //query
        
        return Task.FromResult(new());
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø§Ú¯Ø± Ø¯Ø± `ConfigAttribute` Ú©Ø¯Ù‡Ø§ÛŒ ÙÙˆÙ‚ ØŒ Ù…Ù‚Ø¯Ø§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ `Ttl` ØªÙ†Ø¸ÛŒÙ… Ù†Ú©Ù†ÛŒØ¯ Ùˆ ÛŒØ§ Ø§ÛŒÙ† `Property` Ø±Ø§ 0 Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ù†Ù…Ø§ÛŒÛŒØ¯ ØŒ `Cache` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø¨Ù‡ Ø´Ú©Ù„ Ø¯Ø§Ø¦Ù…ÛŒ Ùˆ Ø¨Ø¯ÙˆÙ† Ø§Ù†Ù‚Ø¶Ø§ Ø¯Ø± `Redis` Ø¨Ø§Ù‚ÛŒ Ø®ÙˆØ§Ù‡Ø¯ Ù…Ø§Ù†Ø¯**

2 . ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ `Cache` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø¯Ø± Ù‚Ø³Ù…Øª Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²

Ø­Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù‚Ø¯Ø§Ø± `Cache` Ø´Ø¯Ù‡ ( Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª ÙÙˆÙ‚ ) Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª ØŒ Ø§Ø² ÙˆØ§Ø³Ø· Ù…ØªÙ†Ø§Ø³Ø¨ Ø¨Ø§ `InternalCache` Ùˆ ÛŒØ§ `ExternalCache` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…ÙˆØ¯ . Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ù‡Ù… Ø¯Ùˆ ÙˆØ§Ø³Ø· `IInternalDistributedCacheMediator` Ùˆ `IExternalDistributedCacheMediator` Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ù†Ø¯ Ú©Ù‡ Ù…ÛŒ ØªÙˆØ§Ù† Ø§Ø² Ø¢Ù†Ù‡Ø§ Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø±Ø¯ .

<div dir="ltr">

```csharp
public class Query : IQuery<List<Dto>>
{
}

public class QueryHandler : IQueryHandler<Query, List<Dto>>
{
    private readonly IInternalDistributedCacheMediator _cacheMediator;

    public QueryHandler(IInternalDistributedCacheMediator cacheMediator) => _cacheMediator = cacheMediator;

    public List<Dto> Handle(Query query)
    {
        var result = _cacheMediator.Get<List<Dto>>(cancellationToken);

        return result;
    }
    
    public async Task<List<Dto>> HandleAsync(Query query, CancellationToken cancellationToken)
    {
        var result = await _cacheMediator.GetAsync<List<Dto>>(cancellationToken);

        return result;
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¨Ø±Ø§ÛŒ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ `Cache` Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² ØŒ Ù‡Ù…Ø§Ù†Ø·ÙˆØ± Ú©Ù‡ Ø¯Ø± Ú©Ø¯Ù‡Ø§ÛŒ ÙÙˆÙ‚ Ù…Ø´Ø®Øµ Ù…ÛŒ Ø¨Ø§Ø´Ø¯ ØŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø±Ø³Ø§Ù„ Ú©Ù„ÛŒØ¯ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø¨Ù‡ Ù…ØªØ¯ `<>Get` Ùˆ `<>GetAsync` Ù†Ù…ÛŒ Ø¨Ø§Ø´Ø¯ ØŒ Ø¨Ù„Ú©Ù‡ Ø§ÛŒÙ† Ù…ØªØ¯ Ø§Ø² Ù†ÙˆØ¹ Ø§Ø±Ø³Ø§Ù„ÛŒ Ø¯Ø± Ù‚Ø³Ù…Øª `Generic` Ùˆ ØªØ·Ø§Ø¨Ù‚ Ø¢Ù† Ø¨Ø§ Ù†ÙˆØ¹ Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ‡ Ø´Ø¯Ù‡ Ø¯Ø± Ù‚Ø³Ù…Øª `Setter` ØŒ Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ Ø±Ø§ ÙˆØ§Ú©Ø´ÛŒ Ù…ÛŒ Ú©Ù†Ø¯**

3 . ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø§Ø¨Ø²Ø§Ø± `DistributedCache` Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù…Ø±Ø¨ÙˆØ·Ù‡

Ø¯Ø± Ù†Ù‡Ø§ÛŒØª Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø§ÛŒÙ† Ù‚Ø§Ø¨Ù„ÛŒØª Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ø®ÙˆØ¯ ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Presentation` Ùˆ Ø¯Ø± ÙØ§ÛŒÙ„ `Program.cs` Ø§Ø² Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
WebApplicationBuilder builder = WebApplication.CreateBuilder();

builder.RegisterDistributedCaching();
```

</div>

Ø¨Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø±Ø´ØªÙ‡ Ø§ØªØµØ§Ù„ Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `Cache` Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ùˆ Ø¯Ø± Ø¨Ø®Ø´ `Properties` Ùˆ Ø¯Ø± ÙØ§ÛŒÙ„ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `launchSettings.json` Ùˆ Ø¯Ø± Ù‚Ø³Ù…Øª `environmentVariables` Ú©Ù„ÛŒØ¯ Ù‡Ø§ÛŒ Ø²ÛŒØ± Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```json
{
  "environmentVariables": {
    "E-RedisConnectionString": "", //external connection
    "I-RedisConnectionString": ""  //internal connection
  }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ù‚Øª Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ù…Ù†Ø·Ù‚ `Cache` Ù‡Ø§ÛŒ Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ù„Ø§ÛŒÙ‡ `UseCase` Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ Ùˆ Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‚Ø±Ø§Ø± Ø¨Ú¯ÛŒØ±Ù†Ø¯**

---

### ğŸ† Ø§Ø¨Ø²Ø§Ø± `MessageBroker` Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒ `EDA`

Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø§Ø² Ø§Ø¨Ø²Ø§Ø± Ù¾Ø± Ú©Ø§Ø±Ø¨Ø±Ø¯ `MessageBroker` Ø´Ø±ÙˆØ¹ Ù†Ù…Ø§ÛŒÛŒÙ… Ú©Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø²ÛŒØ§Ø¯ÛŒ Ø¯Ø± Ø³Ø·Ø­ Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù…ÛŒÚ©Ø±ÙˆØ³Ø±ÙˆÛŒØ³ Ø¯Ø§Ø±Ø¯ .

Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ùˆ Ù†ÛŒØ² Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø²ÛŒØ±Ø³Ø§Ø®Øª Ù‡Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ ( Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ ) ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø§Ø¨ØªØ¯Ø§ Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³ `Domic-TriggerService` Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ø±Ø¯Ù‡ Ùˆ Ø³Ù¾Ø³ Ø¨Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ `Domic.Init.MessageBroker` Ø±ÙØªÙ‡ Ùˆ Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú¯Ø±ÙØªÙ‡ ØªØ§ ØªÙ…Ø§Ù… Ø³Ø§Ø®ØªØ§Ø±Ù‡Ø§ÛŒ `Queue` Ùˆ `Exchange` Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ø²ÛŒØ±Ø³Ø§Ø®ØªÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ `Domic` Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆÙ†Ø¯ .

Ø­Ø§Ù„ Ø¨ÛŒØ§ÛŒÛŒØ¯ Ø¨Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ù‚ÛŒÙ‚ Ø§Ø¨Ø²Ø§Ø± `MessageBroker` Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡ `Domic` Ø¨ÛŒÙ†Ø¯Ø§Ø²ÛŒÙ… .

1 . Ù†Ø­ÙˆÙ‡ Ø§ÛŒØ¬Ø§Ø¯ `Event` Ø¯Ø± Ø³Ø·Ø­ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù†Ù‡Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ `Broker`

Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ù‡Ù… Ø§Ø¨ØªØ¯Ø§ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø§ÛŒÙ† Ù†Ú©ØªÙ‡ Ø§Ø´Ø§Ø±Ù‡ Ú©Ø±Ø¯ Ú©Ù‡ ØªÙ…Ø§Ù…ÛŒ `Event` Ù‡Ø§ Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Domain` Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒ Ø´ÙˆÙ†Ø¯ Ùˆ Ø§Ø² Ø¨ÛŒØ±ÙˆÙ† Ø§Ø² Ø§ÛŒÙ† Ù„Ø§ÛŒÙ‡ ØªÙ†Ù‡Ø§ Ø¨Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø§ÛŒÙ† `Event` Ù‡Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ù¾Ø±Ø¯Ø§Ø®ØªÙ‡ Ù…ÛŒ Ø´ÙˆØ¯ .

<div dir="ltr">

```csharp
//ExchangeType : Exchange.FanOut | Exchange.Direct | Exchange.Headers | Exchange.Topic

//FanOut-Exchange

//create event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange")]
public class Created : CreateDomainEvent<string> //any type of identity key
{
    //payload
}

//update event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange")]
public class Updated : UpdateDomainEvent<string> //any type of identity key
{
    //payload
}

//delete event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange")]
public class Deleted : DeleteDomainEvent<string> //any type of identity key
{
    //payload
}

```
</div>

<div dir="ltr">

```csharp
//ExchangeType : Exchange.FanOut | Exchange.Direct | Exchange.Headers | Exchange.Topic

//Direct-Exchange

//create event
[MessageBroker(ExchangeType = Exchange.Direct, Exchange = "exchange", Route = "route")]
public class Created : CreateDomainEvent<string> //any type of identity key
{
    //payload
}

//update event
[MessageBroker(ExchangeType = Exchange.Direct, Exchange = "exchange", Route = "route")]
public class Updated : UpdateDomainEvent<string> //any type of identity key
{
    //payload
}

//delete event
[MessageBroker(ExchangeType = Exchange.Direct, Exchange = "exchange", Route = "route")]
public class Deleted : DeleteDomainEvent<string> //any type of identity key
{
    //payload
}

```
</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø§Ú¯Ø± Ú†Ù†Ø§Ù†Ú†Ù‡ Ø¯Ø± Ú©Ø¯Ù‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ØŒ Ø³Ø±ÙˆÛŒØ³ Ù…Ø°Ú©ÙˆØ± Ø¹Ù„Ø§ÙˆÙ‡ Ø¨Ø± ØªÙˆÙ„ÛŒØ¯ Ø§ÛŒÙ† Ø±Ø®Ø¯Ø§Ø¯ Ù‡Ø§ ( `Producer` ) ØŒ Ù…ØµØ±Ù Ú©Ù†Ù†Ø¯Ù‡ Ø§ÛŒÙ† Ø±Ø®Ø¯Ø§Ø¯ Ù†ÛŒØ² Ø¨Ø§Ø´Ø¯ ( `Consumer` ) Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ú©Ø±Ø¯**

<div dir="ltr">

```csharp
//FanOut-Exchange

//create event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange", Queue = "queue")]
public class Created : CreateDomainEvent<string> //any type of identity key
{
    //payload
}

//update event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange", Queue = "queue")]
public class Updated : UpdateDomainEvent<string> //any type of identity key
{
    //payload
}

//delete event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange", Queue = "queue")]
public class Deleted : DeleteDomainEvent<string> //any type of identity key
{
    //payload
}
```

</div>

<div dir="ltr">

```csharp
//Direct-Exchange

//create event
[MessageBroker(ExchangeType = Exchange.Direct, Exchange = "exchange", Route = "route", Queue = "queue")]
public class Created : CreateDomainEvent<string> //any type of identity key
{
    //payload
}

//update event
[MessageBroker(ExchangeType = Exchange.Direct, Exchange = "exchange", Route = "route", Queue = "queue")]
public class Updated : UpdateDomainEvent<string> //any type of identity key
{
    //payload
}

//delete event
[MessageBroker(ExchangeType = Exchange.Direct, Exchange = "exchange", Route = "route", Queue = "queue")]
public class Deleted : DeleteDomainEvent<string> //any type of identity key
{
    //payload
}
```

</div>

2 . Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `Event` Ù‡Ø§ÛŒ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Domain`

Ø¨Ø¹Ø¯ Ø§Ø² Ø¢Ù†Ú©Ù‡ `Event` Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Domain` Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù†Ø¯ ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø§Ø² Ø§ÛŒÙ† Ø±Ø®Ø¯Ø§Ø¯ Ù‡Ø§ Ø¯Ø± Ø³Ø·Ø­ Ú©Ù„Ø§Ø³ Ù‡Ø§ÛŒ `Entity` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯ . Ù…ÙˆØ¬ÙˆØ¯ÛŒØª Ù‡Ø§ÛŒ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ Ø¯Ø± Ù„Ø§ÛŒÙ‡ `Domain` Ø¨Ø± Ù¾Ø§ÛŒÙ‡ Ø§Ù„Ú¯ÙˆÛŒ `Rich Domain Model` ØªÙˆØ³Ø¹Ù‡ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù‡ Ø§Ù†Ø¯ Ùˆ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¨Ù‡ Ø§Ø²Ø§ÛŒ Ù‡Ø± `Behavior` Ø§ÛŒ Ú©Ù‡ ØµØ¯Ø§ Ø²Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆØ¯ ØŒ Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² ÛŒÚ© `Event` Ù…Ù†Ø§Ø³Ø¨ Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ø±Ø¯Ø¯ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ù‡Ù… Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…ÙˆØ¯ .

<div dir="ltr">

```csharp
//update event
[MessageBroker(ExchangeType = Exchange.FanOut, Exchange = "exchange")]
public class UpdatedEvent : UpdateDomainEvent<string> //any type of identity key
{
    public string Email    { get; init; }
    public string Username { get; init; }
}

public class DomainEntity : Entity<string> //any type of identity key
{
    public string Id       { get; private set; }
    public string Email    { get; private set; }
    public string Username { get; private set; }
    
    //Behaviors

    public void Change(string username, string email)
    {
        Email    = email;
        Username = username;

        AddEvent(
            new UpdatedEvent {
                Id       = Id       ,
                Username = username ,
                Email    = email    ,
            }
        );
    }
}
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **ØªÙ…Ø§Ù…ÛŒ `Entity` Ù‡Ø§ÛŒ Ø¨Ø®Ø´ `Command` Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø§Ø² Ú©Ù„Ø§Ø³ `<>Entity` Ø§Ø±Ø« Ø¨Ø±ÛŒ Ú©Ù†Ù†Ø¯**

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¨Ø±Ø§ÛŒ Ù‚Ø¯Ù… Ø§ÙˆÙ„ Ù¾Ø±Ø¯Ø§Ø²Ø´ `Event` Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ Ø¯Ø± Ø³Ø·Ø­ Ú©Ù„Ø§Ø³ Ù‡Ø§ÛŒ `Entity` Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ø¯Ø± Ø¯Ø§Ø®Ù„ `Behavior` Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø¯Ø± Ú©Ù„Ø§Ø³ `Entity` Ø§Ø² Ù…ØªØ¯ Ù¾Ø§ÛŒÙ‡ Ø§ÛŒ `AddEvent` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…ÙˆØ¯**

3 . Ø§Ø±Ø³Ø§Ù„ `Event` Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø·Ø­ Ù„Ø§ÛŒÙ‡ `Domain` Ø¨Ù‡ `MessageBroker`
 
Ø¨Ø¹Ø¯ Ø§Ø² Ø§ÛŒØ¬Ø§Ø¯ Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `Event` Ø¯Ø± Ø³Ø·Ø­ Ù„Ø§ÛŒÙ‡ `Domain` ØŒ Ø­Ø§Ù„ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù†Ø­ÙˆÙ‡ Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ† Ø±Ø®Ø¯Ø§Ø¯ Ù‡Ø§ Ø¨Ù‡ `MessageBroker` Ùˆ `EventStreamBroker` Ù…ÙˆØ±Ø¯ Ø¨Ø±Ø±Ø³ÛŒ Ù‚Ø±Ø§Ø± Ú¯ÛŒØ±Ø¯ . Ù¾Ø±Ø¯Ø§Ø²Ø´ `Event` Ù‡Ø§ Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡ `Domic` Ø¨Ù‡ Ø´Ú©Ù„ `OutBox` Ø¨ÙˆØ¯Ù‡ ØŒ Ø¨Ù‡ Ø§ÛŒÙ† ØµÙˆØ±Øª Ú©Ù‡ ØªÙ…Ø§Ù…ÛŒ Ø±Ø®Ø¯Ø§Ø¯Ù‡Ø§ Ø¨Ù‡ Ø´Ú©Ù„ `Transactional` Ø¯Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒ Ø´ÙˆÙ†Ø¯ . Ø§Ù„Ø¨ØªÙ‡ Ø§ÛŒÙ† Ù†Ú©ØªÙ‡ Ø±Ø§ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØª Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…ÙˆØ¶ÙˆØ¹ Ø­ØªÙ…Ø§ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª `WithTransactionAttribute` Ø¯Ø± Ù‚Ø³Ù…Øª `Command` Ù…Ù†Ø·Ù‚ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‚Ø±Ø§Ø± Ø¨Ú¯ÛŒØ±Ø¯ .

Ø­Ø§Ù„ Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù¾Ø±Ø¯Ø§Ø²Ø´ `OutBox` ØªÙ…Ø§Ù…ÛŒ Ø±Ø®Ø¯Ø§Ø¯Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…ÙˆØ¯ .

<div dir="ltr">

```csharp
WebApplicationBuilder builder = WebApplication.CreateBuilder();

builder.RegisterEventsPublisher();    //for [ MessageBroker ( RabbitMQ ) ]
builder.RegisterDistributedCaching(); //for [ DistributedLock ] handling
```

</div>

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± Ù†Ø¸Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ `OutBox` Ø±Ø®Ø¯Ø§Ø¯Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ØŒ Ø¨Ù‡ Ø¬Ù‡Øª Ù…Ø¯ÛŒØ±ÛŒØª `Concurrency` Ø¯Ø± `Instance` Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„ÙÛŒ Ú©Ù‡ Ø§Ø² Ø³Ø±ÙˆÛŒØ³ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒ Ø´ÙˆØ¯ ØŒ Ø¨Ù‡ Ø§Ø¨Ø²Ø§Ø± `InternalDistributedCache` Ù†ÛŒØ§Ø² Ø¯Ø§Ø±Ø¯**

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¨Ø§Ø²Ù‡ ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø¬Ø¯Ø¯ `Job` Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ `OutBox` Ø±Ø®Ø¯Ø§Ø¯Ù‡Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ ØŒ `5` Ø«Ø§Ù†ÛŒÙ‡ Ù…ÛŒ Ø¨Ø§Ø´Ø¯**

4 . Ù¾Ø±Ø¯Ø§Ø²Ø´ Ùˆ Ù…ØµØ±Ù Ú©Ø±Ø¯Ù† `Event` Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡

Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…Ù‡Ù…ØªØ±ÛŒÙ† Ù‚Ø³Ù…Øª Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡ `Domic` Ù…ÛŒ Ø¨Ø§Ø´Ø¯ ØŒ Ø²ÛŒØ±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø±Ø®Ø¯Ø§Ø¯Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ Ø¨Ù‡ ÙˆØ§Ø³Ø·Ù‡ Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù ØŒ Ø¨Ø³ÛŒØ§Ø± Ù…ÙˆØ¶ÙˆØ¹ Ù…Ù‡Ù… Ùˆ Ø§ØµØ·Ù„Ø§Ø­Ø§ `Critical` Ù…ÛŒ Ø¨Ø§Ø´Ø¯ Ú©Ù‡ Ø¹Ø¯Ù… Ø±Ø¹Ø§ÛŒØª Ù†Ú©Ø§Øª Ø±ÛŒØ² ÙÙ†ÛŒ Ùˆ Ø¯Ù‚Øª Ø¨Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª ØŒ Ø¨Ø§Ø¹Ø« Ø¨Ø±ÙˆØ² `Inconsistancy` Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ù…Ø§Ø¨ÛŒÙ† Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ Ù…ÛŒ Ú¯Ø±Ø¯Ø¯ .

Ø®ÙˆØ´Ø¨Ø®ØªØ§Ù†Ù‡ Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡ `Domic` Ø¨Ù‡ ØªÙ…Ø§Ù…ÛŒ Ø§ÛŒÙ† Ù…ÙˆØ§Ø±Ø¯ Ùˆ Ù†Ú©Ø§Øª ØªÙˆØ¬Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª Ùˆ Ú©Ø§Ø±Ø¨Ø± Ù†Ù‡Ø§ÛŒÛŒ ØŒ ØµØ±ÙØ§ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ù…Ø·Ø±Ø­ Ø´Ø¯Ù‡ Ø¹Ù…Ù„ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ù‡Ø± Ú†Ù‡ ØªÙ…Ø§Ù… ØªØ± Ø¨Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø§ÛŒÙ† `Event` Ù‡Ø§ Ø¯Ø± Ø¨Ø³ØªØ± `MessageBroker` Ø¨Ù¾Ø±Ø¯Ø§Ø²Ø¯ .

Ø¯Ø± Ø§Ø¨ØªØ¯Ø§ ØŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ `Event` Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ ØªÙˆØ³Ø· Ø³Ø±ÙˆÛŒØ³ Ù‡Ø§ÛŒ `Producer` ØŒ Ù…ÛŒ Ø¨Ø§ÛŒØ³Øª Ú©Ù„Ø§Ø³ Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡ ( `Consumer` ) Ø¯Ø± Ù„Ø§ÛŒÙ‡ `UseCase` Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆÙ†Ø¯ . Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ù‡Ù… Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø²ÛŒØ± Ø¹Ù…Ù„ Ù†Ù…Ø§ÛŒÛŒØ¯ .

<div dir="ltr">

```csharp
public class UpdatedConsumerEventBusHandler : IConsumerEventBusHandler<UpdatedEvent>
{
    public UpdatedConsumerEventBusHandler(){}

    [TransactionConfig(Type = TransactionType.Command)] //or => Type = TransactionType.Query
    public void Handle(UpdatedEvent @event)
    {
        //logic
    }
    
    [TransactionConfig(Type = TransactionType.Command)] //or => Type = TransactionType.Query
    public Task HandleAsync(UpdatedEvent @event, CancellationToken cancellationToken)
    {
        //logic
        
        return Task.CompleteTask;
    }
}
```

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ù¾Ø±ÙˆÚ˜Ù‡ `Domic` Ø¨Ø± Ù¾Ø§ÛŒÙ‡ Ø§Ù„Ú¯ÙˆÛŒ Ø·Ø±Ø§Ø­ÛŒ `CQRS` Ú©Ù‡ ÛŒÚ© Ø§Ù„Ú¯ÙˆÛŒ `System Design` Ø§ÛŒÛŒ Ù…ÛŒ Ø¨Ø§Ø´Ø¯ ØŒ ØªÙˆØ³Ø¹Ù‡ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª . Ù„Ø°Ø§ Ø¯Ø± Ø¨Ø®Ø´ `Consume` Ú©Ø±Ø¯Ù† `Event` Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ Ø­ØªÙ…Ø§ Ø¨Ø§ÛŒØ¯ Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø§Ø² Ù†Ø¸Ø± `Command` Ùˆ ÛŒØ§ `Query` Ø¨ÙˆØ¯Ù† Ù…Ø´Ø®Øµ Ø´ÙˆØ¯**

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ØªØ±Ø§Ú©Ù†Ø´ Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ `Query` Ø¯Ø± Ù…Ø¯ÛŒØ±ÛŒØª `Event` Ùˆ Ù†ÛŒØ² `Message` ØŒ Ù¾ÛŒØ´ ØªØ± Ø¯Ø± Ù‚Ø³Ù…Øª `Command` Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø§Ù„Ú¯ÙˆÛŒ `Mediator` Ú¯ÙØªÙ‡ Ø´Ø¯ Ú©Ù‡ Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù†ÛŒØ² Ù…Ø´Ø§Ø¨Ù‡ Ø¢Ù† Ù…ÛŒ Ø¨Ø§Ø´Ø¯ Ù…Ù†ØªÙ‡Ø§ Ø¨Ø§ ÛŒÚ© ØªÙØ§ÙˆØª Ùˆ Ø¢Ù† Ø§ÛŒÙ† Ø§Ø³Øª Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø¬Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ `ICoreCommandUnitOfWork` ØŒ ÙˆØ§Ø³Ø· `ICoreQueryUnitOfWork` Ù¾ÛŒØ§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø´ÙˆØ¯**

ğŸ”¥ **ØªÙˆØ¬Ù‡** : **Ø¯Ø± Ù†Ø¸Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø¯Ø± Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª `Event` Ù‡Ø§ Ùˆ ÛŒØ§ `Message` Ù‡Ø§ ØŒ ØªÙ…Ø§Ù… ÙØ±Ø¢ÛŒÙ†Ø¯ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÛŒØ´ÙØ±Ø¶ Ùˆ Ø«Ø§Ø¨Øª ØŒ Ø¯Ø± ÛŒÚ© `Transaction Boundary` ØµÙˆØ±Øª Ù…ÛŒ Ú¯ÛŒØ±Ø¯ Ùˆ ØµØ±ÙØ§ Ø´Ù…Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ù†Ø¯Ù‡ Ø±Ø®Ø¯Ø§Ø¯ Ù…Ø±Ø¨ÙˆØ·Ù‡ ØŒ Ø¨Ø§ÛŒØ¯ Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´ Ø±Ø§ ( `Command` Ùˆ ÛŒØ§ `Query` ) Ù…Ø´Ø®Øµ Ù†Ù…Ø§ÛŒÛŒØ¯ØŒ Ø¨Ù‡ Ø§ÛŒÙ† Ù…Ø¹Ù†ÛŒ Ú©Ù‡ Ø§ÛŒÙ† Ø±Ø®Ø¯Ø§Ø¯ Ùˆ ÛŒØ§ `Message` Ø¨Ø± Ú©Ø¯Ø§Ù… Ø¨Ø®Ø´ Ù¾Ø±ÙˆÚ˜Ù‡ ( Ø¨Ù‡ØªØ± Ø§Ø³Øª Ø¨Ú¯ÙˆÛŒÛŒÙ… Ø¯ÛŒØªØ§Ø¨ÛŒØ³ ) Ù‚Ø±Ø§Ø± Ø§Ø³Øª Ø§Ø«Ø± Ø¨Ú¯Ø°Ø§Ø±Ø¯ ØŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ `Command` Ùˆ ÛŒØ§ `Query`**

</div>

</div>